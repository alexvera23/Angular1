<div class="wrapper p-3">
  <mat-card class="profesor-card">
    <mat-card-content>
      <form [formGroup]="maestroForm" (ngSubmit)="registrar()">
        <h3 class="title-user mb-4">Ingresa los datos del Profesor</h3>
        <mat-divider class="mb-4"></mat-divider>

        <!-- ID de Trabajador -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>ID de Trabajador</mat-label>
          <input matInput type="text" formControlName="n_empleado" placeholder="Escribe el No. de Empleado">
          <mat-icon matPrefix>badge</mat-icon>
          <mat-error *ngIf="maestroForm.get('n_empleado')?.hasError('required')">
            El No. de Empleado es requerido
          </mat-error>
        </mat-form-field>

        <!-- Nombre -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Nombre(s)</mat-label>
          <input matInput type="text" formControlName="first_name" 
                 placeholder="Escribe el nombre" 
                 (keypress)="soloLetras($event)">
          <mat-icon matPrefix>person</mat-icon>
          <mat-error *ngIf="maestroForm.get('first_name')?.hasError('required')">
            El nombre es requerido
          </mat-error>
        </mat-form-field>

        <!-- Apellidos -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Apellidos</mat-label>
          <input matInput type="text" formControlName="last_name" 
                 placeholder="Escribe los apellidos" 
                 (keypress)="soloLetras($event)">
          <mat-icon matPrefix>person_outline</mat-icon>
          <mat-error *ngIf="maestroForm.get('last_name')?.hasError('required')">
            Los apellidos son requeridos
          </mat-error>
        </mat-form-field>

        <!-- Correo Electrónico -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Correo Electrónico</mat-label>
          <input matInput type="email" formControlName="email" placeholder="nombre@correo.com">
          <mat-icon matPrefix>email</mat-icon>
          <mat-error *ngIf="maestroForm.get('email')?.hasError('required')">
            El correo es requerido
          </mat-error>
          <mat-error *ngIf="maestroForm.get('email')?.hasError('email')">
            El formato es inválido
          </mat-error>
        </mat-form-field>

        <!-- Contraseña (solo si no se edita) -->
        <mat-form-field appearance="outline" class="w-100 mb-2" *ngIf="!editar">
          <mat-label>Contraseña</mat-label>
          <input matInput [type]="hide ? 'password' : 'text'" 
                 formControlName="password" 
                 placeholder="Mínimo 8 caracteres">
          <mat-icon matPrefix>lock</mat-icon>
          <button mat-icon-button matSuffix type="button" (click)="hide = !hide">
            <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
          <mat-error *ngIf="maestroForm.get('password')?.hasError('required')">
            La contraseña es requerida
          </mat-error>
          <mat-error *ngIf="maestroForm.get('password')?.hasError('minlength')">
            Debe tener al menos 8 caracteres
          </mat-error>
        </mat-form-field>

        <!-- Confirmar Contraseña (solo si no se edita) -->
        <mat-form-field appearance="outline" class="w-100 mb-2" *ngIf="!editar">
          <mat-label>Confirmar Contraseña</mat-label>
          <input matInput [type]="hideConfirm ? 'password' : 'text'" 
                 formControlName="confirmar_password" 
                 placeholder="Repite la contraseña">
          <mat-icon matPrefix>lock_outline</mat-icon>
          <button mat-icon-button matSuffix type="button" (click)="hideConfirm = !hideConfirm">
            <mat-icon>{{hideConfirm ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
          <mat-error *ngIf="maestroForm.get('confirmar_password')?.hasError('required')">
            La confirmación es requerida
          </mat-error>
        </mat-form-field>

        <!-- Fecha de Nacimiento -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Fecha de Nacimiento</mat-label>
          <input matInput [matDatepicker]="picker" formControlName="fecha_nacimiento">
          <mat-icon matPrefix>cake</mat-icon>
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
          <mat-error *ngIf="maestroForm.get('fecha_nacimiento')?.hasError('required')">
            La fecha de nacimiento es requerida
          </mat-error>
        </mat-form-field>

        <!-- Teléfono -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Teléfono</mat-label>
          <input matInput type="tel" formControlName="telefono" 
                 mask='(000) 000-0000' 
                 placeholder="(000) 000-0000">
          <mat-icon matPrefix>phone</mat-icon>
          <mat-error *ngIf="maestroForm.get('telefono')?.hasError('required')">
            El teléfono es requerido
          </mat-error>
        </mat-form-field>

        <!-- Cubículo -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Cubículo</mat-label>
          <input matInput type="text" formControlName="cubiculo" placeholder="Escribe el cubículo">
          <mat-icon matPrefix>meeting_room</mat-icon>
          <mat-error *ngIf="maestroForm.get('cubiculo')?.hasError('required')">
            El cubículo es requerido
          </mat-error>
        </mat-form-field>

        <!-- Área de Investigación -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Área de Investigación</mat-label>
          <input matInput type="text" formControlName="area_investigacion" 
                 placeholder="Escribe el área de investigación">
          <mat-icon matPrefix>science</mat-icon>
          <mat-error *ngIf="maestroForm.get('area_investigacion')?.hasError('required')">
            El área de investigación es requerida
          </mat-error>
        </mat-form-field>

        <!-- Materias a Impartir -->
        <div class="materias-section mb-3">
          <label class="materias-label">
            <mat-icon class="label-icon">school</mat-icon>
            Selecciona las materias a impartir
          </label>
          <mat-card class="materias-card">
            <mat-card-content class="materias-content">
              <div class="row">
                <div *ngFor="let materia of materiasData" class="col-12 col-md-6 mb-2">
                  <mat-checkbox 
                    [value]="materia.id.toString()"
                    (change)="onCheckboxChange($event)"
                    color="primary">
                    {{ materia.nombre }}
                  </mat-checkbox>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
          <div *ngIf="maestroForm.get('materias')?.invalid && maestroForm.get('materias')?.touched" 
               class="mat-error mt-2">
            Debes seleccionar al menos una materia
          </div>
        </div>

        <!-- Botones -->
        <div class="d-flex justify-content-end gap-2 mt-4">
          <button mat-raised-button color="primary" type="submit">
            <mat-icon>save</mat-icon>
            Registrar Profesor
          </button>
        </div>
      </form>
    </mat-card-content>
  