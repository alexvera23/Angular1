<div class="wrapper p-3">
  <mat-card class="alumno-card">
    <mat-card-content>
      <form [formGroup]="alumnoForm" (ngSubmit)="registrar()">
        <h3 class="title-user mb-4">Ingresa los datos del Alumno</h3>
        <mat-divider class="mb-4"></mat-divider>

        <!-- ID/Matrícula -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>ID/Matrícula</mat-label>
          <input matInput type="text" formControlName="matricula" placeholder="Escribe la matrícula">
          <mat-icon matPrefix>badge</mat-icon>
          <mat-error *ngIf="alumnoForm.get('matricula')?.hasError('required')">
            La matrícula es requerida
          </mat-error>
        </mat-form-field>

        <!-- Nombre -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Nombre(s)</mat-label>
          <input matInput type="text" formControlName="first_name" placeholder="Escribe el nombre">
          <mat-icon matPrefix>person</mat-icon>
          <mat-error *ngIf="alumnoForm.get('first_name')?.hasError('required')">
            El nombre es requerido
          </mat-error>
        </mat-form-field>

        <!-- Apellidos -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Apellidos</mat-label>
          <input matInput type="text" formControlName="last_name" placeholder="Escribe los apellidos">
          <mat-icon matPrefix>person_outline</mat-icon>
          <mat-error *ngIf="alumnoForm.get('last_name')?.hasError('required')">
            Los apellidos son requeridos
          </mat-error>
        </mat-form-field>

        <!-- Correo Electrónico -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Correo Electrónico</mat-label>
          <input matInput type="email" formControlName="email" placeholder="nombre@correo.com">
          <mat-icon matPrefix>email</mat-icon>
          <mat-error *ngIf="alumnoForm.get('email')?.hasError('required')">
            El correo es requerido
          </mat-error>
          <mat-error *ngIf="alumnoForm.get('email')?.hasError('email')">
            El formato del correo es inválido
          </mat-error>
        </mat-form-field>

        <!-- Contraseña (solo si no se edita) -->
        <mat-form-field appearance="outline" class="w-100 mb-2" *ngIf="!editar">
          <mat-label>Contraseña</mat-label>
          <input matInput [type]="hide ? 'password' : 'text'" 
                 formControlName="password" 
                 placeholder="Mínimo 8 caracteres">
          <mat-icon matPrefix>lock</mat-icon>
          <button mat-icon-button matSuffix type="button" (click)="hide = !hide">
            <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
          <mat-error *ngIf="alumnoForm.get('password')?.hasError('required')">
            La contraseña es requerida
          </mat-error>
          <mat-error *ngIf="alumnoForm.get('password')?.hasError('minlength')">
            Debe tener al menos 8 caracteres
          </mat-error>
        </mat-form-field>

        <!-- Confirmar Contraseña (solo si no se edita) -->
        <mat-form-field appearance="outline" class="w-100 mb-2" *ngIf="!editar">
          <mat-label>Confirmar Contraseña</mat-label>
          <input matInput [type]="hideConfirm ? 'password' : 'text'" 
                 formControlName="confirmar_password" 
                 placeholder="Repite la contraseña">
          <mat-icon matPrefix>lock_outline</mat-icon>
          <button mat-icon-button matSuffix type="button" (click)="hideConfirm = !hideConfirm">
            <mat-icon>{{hideConfirm ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
          <mat-error *ngIf="alumnoForm.get('confirmar_password')?.hasError('required')">
            La confirmación es requerida
          </mat-error>
        </mat-form-field>

        <!-- Fecha de Nacimiento -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Fecha de Nacimiento</mat-label>
          <input matInput [matDatepicker]="picker" formControlName="fecha_nacimiento">
          <mat-icon matPrefix>cake</mat-icon>
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
          <mat-error *ngIf="alumnoForm.get('fecha_nacimiento')?.hasError('required')">
            La fecha de nacimiento es requerida
          </mat-error>
        </mat-form-field>

        <!-- CURP -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>CURP</mat-label>
          <input matInput type="text" formControlName="curp" 
                 placeholder="Escribe el CURP" 
                 maxlength="18"
                 class="text-uppercase">
          <mat-icon matPrefix>fingerprint</mat-icon>
          <mat-hint>18 caracteres</mat-hint>
          <mat-error *ngIf="alumnoForm.get('curp')?.hasError('required')">
            El CURP es requerido
          </mat-error>
          <mat-error *ngIf="alumnoForm.get('curp')?.hasError('pattern')">
            El formato del CURP es inválido
          </mat-error>
        </mat-form-field>

        <!-- RFC -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>RFC</mat-label>
          <input matInput type="text" formControlName="rfc" 
                 placeholder="Escribe el RFC"
                 class="text-uppercase">
          <mat-icon matPrefix>description</mat-icon>
          <mat-hint>12 o 13 caracteres</mat-hint>
          <mat-error *ngIf="alumnoForm.get('rfc')?.hasError('required')">
            El RFC es requerido
          </mat-error>
          <mat-error *ngIf="alumnoForm.get('rfc')?.hasError('minlength') || alumnoForm.get('rfc')?.hasError('maxlength')">
            Debe tener 12 o 13 caracteres
          </mat-error>
        </mat-form-field>

        <!-- Edad -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Edad</mat-label>
          <input matInput type="number" formControlName="edad" placeholder="Escribe la edad">
          <mat-icon matPrefix>calendar_today</mat-icon>
          <mat-error *ngIf="alumnoForm.get('edad')?.hasError('required')">
            La edad es requerida
          </mat-error>
        </mat-form-field>

        <!-- Teléfono -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Teléfono</mat-label>
          <input matInput type="tel" formControlName="telefono" 
                 mask='(000) 000-0000' 
                 placeholder="(000) 000-0000">
          <mat-icon matPrefix>phone</mat-icon>
          <mat-error *ngIf="alumnoForm.get('telefono')?.hasError('required')">
            El teléfono es requerido
          </mat-error>
        </mat-form-field>

        <!-- Ocupación (Opcional) -->
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Ocupación (Opcional)</mat-label>
          <input matInput type="text" formControlName="ocupacion" placeholder="Escribe la ocupación">
          <mat-icon matPrefix>work_outline</mat-icon>
        </mat-form-field>

        <!-- Botones -->
        <div class="d-flex justify-content-end gap-2 mt-4">
          <button mat-raised-button color="primary" type="submit">
            <mat-icon>save</mat-icon>
            Registrar Alumno
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>